<div class="min-h-screen bg-gray-100 p-6">
  <div class="bg-white p-6 rounded-xl shadow-lg max-w-4xl mx-auto">
    <h2 class="text-2xl font-bold text-blue-900 mb-6 text-center">Gestion de Art√≠culos</h2>


    <div class="flex border-b mb-6">
      <button
        class="px-4 py-2 -mb-px border-b-2 font-medium focus:outline-none"
        [ngClass]="{
          'border-blue-600 text-blue-600': pestaniaActiva === 'formulario',
          'border-transparent text-gray-500 hover:text-gray-700': pestaniaActiva !== 'formulario'
        }"
        (click)="pestaniaActiva = 'formulario'"
      >
        Formulario
      </button>
      <button
        class="px-4 py-2 -mb-px border-b-2 font-medium focus:outline-none"
        [ngClass]="{
          'border-blue-600 text-blue-600': pestaniaActiva === 'tabla',
          'border-transparent text-gray-500 hover:text-gray-700': pestaniaActiva !== 'tabla'
        }"
        (click)="pestaniaActiva = 'tabla'"
      >
        Tabla
      </button>
    </div>


    <!-- FORMULARIO -->

     <div *ngIf="pestaniaActiva === 'formulario'">
    <form [formGroup]="articuloForm" (ngSubmit)="guardarArticulo()" class="grid gap-4 mb-8">
      <div>
        <label class="block font-medium text-gray-700 mb-1">Nombre:</label>
        <input
          formControlName="nombre"
          type="text"
          class="w-full border border-gray-300 rounded-md px-4 py-2"
          [class.border-red-500]="articuloForm.get('nombre')?.invalid && articuloForm.get('nombre')?.touched"
        />
        <div *ngIf="articuloForm.get('nombre')?.invalid && articuloForm.get('nombre')?.touched" class="text-red-600 text-sm mt-1">
          El nombre es obligatorio.
        </div>
      </div>

      <div>
        <label class="block font-medium text-gray-700 mb-1">Descripci√≥n:</label>
        <input
          formControlName="descripcion"
          type="text"
          class="w-full border border-gray-300 rounded-md px-4 py-2"
          [class.border-red-500]="articuloForm.get('descripcion')?.invalid && articuloForm.get('descripcion')?.touched"
        />
         <div *ngIf="articuloForm.get('descripcion')?.invalid && articuloForm.get('descripcion')?.touched" class="text-red-600 text-sm mt-1">
           La descripcion es obligatoria.
        </div>
      </div>

      <div>
        <label class="block font-medium text-gray-700 mb-1">Precio:</label>
        <input
          formControlName="precio"
          type="number"
          class="w-full border border-gray-300 rounded-md px-4 py-2"
           [class.border-red-500]="articuloForm.get('precio')?.invalid && articuloForm.get('precio')?.touched"
        />
        <div *ngIf="articuloForm.get('precio')?.invalid && articuloForm.get('precio')?.touched" class="text-red-600 text-sm mt-1">
          El precio debe ser un n√∫mero mayor a 0.
        </div>
      </div>

      <div>
        <label class="block font-medium text-gray-700 mb-1">Existencia:</label>
        <input
          formControlName="existencia"
          type="number"
          class="w-full border border-gray-300 rounded-md px-4 py-2"
        />
      </div>

      <div class="flex gap-3 mt-4">
        <button
          type="submit"
          class="bg-green-600 hover:bg-green-500 text-white px-6 py-2 rounded-md"
        >
          {{ modoEditar ? 'Actualizar' : 'Crear' }}
        </button>

        <button
          type="button"
          *ngIf="modoEditar"
          (click)="cancelarEditar()"
          class="bg-gray-400 hover:bg-gray-500 text-white px-6 py-2 rounded-md"
        >
          Cancelar
        </button>
      </div>
    </form>
    </div>

    <!-- TABLA -->

    <div *ngIf="pestaniaActiva === 'tabla'">
    <table class="w-full bg-white border border-gray-300 rounded-md text-sm">
      <thead class="bg-gray-200 text-gray-700">
        <tr>
          <th class="py-2 px-4 text-left">ID</th>
          <th class="py-2 px-4 text-left">Nombre</th>
          <th class="py-2 px-4 text-left">Descripci√≥n</th>
          <th class="py-2 px-4 text-left">Precio</th>
          <th class="py-2 px-4 text-left">Existencia</th>
          <th class="py-2 px-4 text-left">Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let art of articulos" class="border-t hover:bg-gray-50">
          <td class="py-2 px-4">{{ art.id_articulo }}</td>
          <td class="py-2 px-4">{{ art.nombre }}</td>
          <td class="py-2 px-4">{{ art.descripcion }}</td>
          <td class="py-2 px-4">{{ art.precio }}</td>
          <td class="py-2 px-4">{{ art.existencia }}</td>
          <td class="py-2 px-4">
            <button
              class="text-blue-600 hover:underline mr-2"
              (click)="editarArticulo(art); pestaniaActiva ='formulario';"
            >
               üñãÔ∏è Editar
            </button>
            <button
              class="text-red-600 hover:underline"
              (click)="confirmarEliminacionArticulo(art.id_articulo!)"
            >
              üóëÔ∏è Eliminar
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
</div>

<div *ngIf="articuloAEliminar !== null" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50">
  <div class="bg-white p-6 rounded-xl shadow-md w-full max-w-md text-center">
    <p class="text-lg font-semibold mb-4">¬øEst√°s seguro que deseas eliminar este articulo?</p>
    <div class="flex justify-center gap-4">
      <button (click)="eliminarArticuloConfirmado()" class="bg-red-600 hover:bg-red-500 text-white px-4 py-2 rounded">S√≠, eliminar</button>
      <button (click)="cancelarEliminacionArticulo()" class="bg-gray-300 hover:bg-gray-400 text-black px-4 py-2 rounded">Cancelar</button>
    </div>
  </div>
</div>
